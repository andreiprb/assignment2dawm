<div class="coffee-form-container">
  <div class="form-header">
    <h2>{{ formTitle }}</h2>
  </div>

  <form nz-form [formGroup]="coffeeForm" (ngSubmit)="submitForm()">
    <nz-form-item>
      <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="name">Coffee Name</nz-form-label>
      <nz-form-control [nzSm]="14" [nzXs]="24" nzErrorTip="Please input a valid coffee name (min 3 characters)">
        <input nz-input formControlName="name" id="name" placeholder="Coffee name" />
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="origin">Origin</nz-form-label>
      <nz-form-control [nzSm]="14" [nzXs]="24" nzErrorTip="Please input the coffee's origin">
        <input nz-input formControlName="origin" id="origin" placeholder="Country of origin" />
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="roastLevel">Roast Level</nz-form-label>
      <nz-form-control [nzSm]="14" [nzXs]="24" nzErrorTip="Please select a roast level">
        <nz-select formControlName="roastLevel" id="roastLevel" nzPlaceHolder="Select a roast level">
          @for (level of roastLevels; track level.value) {
            <nz-option [nzValue]="level.value" [nzLabel]="level.label"></nz-option>
          }
        </nz-select>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="price">Price (USD)</nz-form-label>
      <nz-form-control [nzSm]="14" [nzXs]="24" [nzErrorTip]="priceErrorTpl">
        <nz-input-number
          formControlName="price"
          id="price"
          [nzMin]="0.1"
          [nzMax]="100"
          [nzStep]="0.01"
          [nzPrecision]="2"
          [nzPlaceHolder]="'Price in USD'"
          style="width: 100%;">
        </nz-input-number>
        <ng-template #priceErrorTpl let-control>
          @if (control.hasError('required')) {
            <span>Please input the price</span>
          } @else if (control.hasError('min')) {
            <span>Price must be greater than $0.10</span>
          } @else if (control.hasError('priceMax')) {
            <span>Price cannot exceed $100.00</span>
          }
        </ng-template>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="temperature">Temperature (°C)</nz-form-label>
      <nz-form-control [nzSm]="14" [nzXs]="24" [nzErrorTip]="tempErrorTpl">
        <nz-input-number
          formControlName="temperature"
          id="temperature"
          [nzMin]="70"
          [nzMax]="100"
          [nzStep]="1"
          [nzPlaceHolder]="'Brewing temperature'"
          style="width: 100%;">
        </nz-input-number>
        <ng-template #tempErrorTpl let-control>
          @if (control.hasError('required')) {
            <span>Please input the brewing temperature</span>
          } @else if (control.hasError('min') || control.hasError('max')) {
            <span>Temperature must be between 70°C and 100°C</span>
          }
        </ng-template>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-control [nzOffset]="6" [nzSpan]="14">
        <div class="form-actions">
          <button nz-button nzType="default" (click)="cancel()">Cancel</button>
          <button nz-button nzType="primary" type="submit" [disabled]="coffeeForm.invalid">Save</button>
        </div>
      </nz-form-control>
    </nz-form-item>
  </form>
</div>
